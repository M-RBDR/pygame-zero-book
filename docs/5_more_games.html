<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link href="stylesheets/pygments.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/softcover.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/custom.css" media="screen" rel="stylesheet" type="text/css" />
    
    <title>pygame-book</title>
    
      <script type="text/x-mathjax-config">
              MathJax.Hub.Config({
        "HTML-CSS": {
          availableFonts: ["TeX"],
        },
        TeX: {
          extensions: ["AMSmath.js", "AMSsymbols.js", "color.js"],
          equationNumbers: {
            autoNumber: "AMS",
            formatNumber: function (n) { return "6" + '.' + n }
          },
          Macros: {
            PolyTeX:    "Poly{\\TeX}",
            PolyTeXnic: "Poly{\\TeX}nic",
            "softcover": "\\texttt{softcover}",
"unitvec": ["{\\hat #1}", 1]
          }
        },
        showProcessingMessages: false,
        messageStyle: "none",
        imageFont: null,
        "AssistiveMML": { disabled: true }
      });

        if (/PhantomJS/.test(window.navigator.userAgent)) {
          MathJax.Hub.Queue([alert, 'MathJax Done']);
        }
      </script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_SVG"></script>
    
  </head>
  <body>
    
    <div id="book">
      <div id="cid32" data-tralics-id="cid32" class="chapter" data-number="6" data-chapter="5_more_games"><h1><a href="5_more_games.html#cid32" class="heading hyperref"><span class="number">Lesson 6 </span>More games</a></h1>
<p class="noindent">These games demonstrate some essential building blocks you will need to make more advanced games of your own.</p>
</div>
<div id="cid33" data-tralics-id="cid33" class="section" data-number="6.1"><h2><a href="5_more_games.html#cid33" class="heading hyperref"><span class="number">6.1 </span>Array lists</a></h2>
<p class="noindent">We introduced arrays in <a href="5_more_games.html#code-arrays" class="hyperref">Program <span class="ref">4.5</span></a>.</p>
<p>In this game, we create an empty array <em>[]</em> and use a loop to fill it with aliens.</p>
<p>We again use loops to draw all the aliens and move all the aliens in the array.</p>
<p>When the mouse is clicked we add a new alien to the array.</p>
<div class="codelisting" id="code-arrays" data-tralics-id="uid79" data-number="6.1"><div class="heading"><span class="number">Program 6.1:</span> <span class="description">Array lists are useful in games!</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">aliens</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">aliens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Actor</span><span class="p">(</span><span class="s1">'alien'</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">30</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">alien</span> <span class="ow">in</span> <span class="n">aliens</span><span class="p">:</span>
        <span class="n">alien</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">alien</span> <span class="ow">in</span> <span class="n">aliens</span><span class="p">:</span>
        <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
            <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">on_mouse_down</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
    <span class="n">aliens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Actor</span><span class="p">(</span><span class="s1">'alien'</span><span class="p">,</span> <span class="n">pos</span><span class="p">))</span>
</pre></div></div></div><ul>
<li>Go back to a previous game (e.g.<span class="intersentencespace"></span> <a href="2_simple_games.html#code-collisions" class="hyperref">Program <span class="ref">3.1</span></a>)
make an array of bullets that move up the screen.<span class="intersentencespace"></span> When the player presses the spacebar to shoot,
add a new bullet to the array.<span class="intersentencespace"></span>
</li></ul>
</div>
<div id="cid34" data-tralics-id="cid34" class="section" data-number="6.2"><h2><a href="5_more_games.html#cid34" class="heading hyperref"><span class="number">6.2 </span>Animation</a></h2>
<p class="noindent">Animation is another use for functions.<span class="intersentencespace"></span> (See <a href="3_python_fundamentals.html#code-functions" class="hyperref">Program <span class="ref">4.6</span></a>) We define our own function and then ask Pygame to <em>call it back</em>
every 0.2 seconds.<span class="intersentencespace"></span> Most of this code is from <a href="2_simple_games.html#code-collisions" class="hyperref">Program <span class="ref">3.1</span></a>.</p>
<div class="codelisting" id="code-animation" data-tralics-id="uid81" data-number="6.2"><div class="heading"><span class="number">Program 6.2:</span> <span class="description">Animation</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="n">alien</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="s2">"alien"</span><span class="p">)</span>
<span class="n">alien</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">alien</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">keyboard</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
        <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">keyboard</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
        <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">alien</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>

<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"alien_hurt"</span><span class="p">,</span> <span class="s2">"alien"</span><span class="p">]</span>
<span class="n">image_counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">animateAlien</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">image_counter</span>
    <span class="n">alien</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">image_counter</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)]</span>
    <span class="n">image_counter</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">animateAlien</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div></div></div><ul>
<li>Make the alien animate faster.<span class="intersentencespace"></span>
</li>
<li>Add another image to list of images.<span class="intersentencespace"></span>
</li>
<li>Draw your own animation, e.g.<span class="intersentencespace"></span> a man walking left which plays when the left key is pressed
</li></ul>
</div>
<div id="cid35" data-tralics-id="cid35" class="section" data-number="6.3"><h2><a href="5_more_games.html#cid35" class="heading hyperref"><span class="number">6.3 </span>Simple physics</a></h2>
<p class="noindent">Instead of moving this ball by a fixed number of pixels, we store the number of pixels to move in variables, <em>vx</em> and <em>vy</em>.<span class="intersentencespace"></span> These are velocities, i.e.<span class="intersentencespace"></span> speed in a fixed direction.<span class="intersentencespace"></span> This allow us to change the velocity - reverse it in fact - when the ball hits the edge.</p>
<div class="codelisting" id="code-simple_physics" data-tralics-id="uid85" data-number="6.3"><div class="heading"><span class="number">Program 6.3:</span> <span class="description">Simple physics: velocity</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">ball</span> <span class="o">=</span> <span class="n">Rect</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">vx</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">vy</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">filled_rect</span><span class="p">(</span><span class="n">ball</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">vx</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">vy</span>
    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span> <span class="ow">or</span> <span class="n">ball</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">vx</span>
    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="n">ball</span><span class="o">.</span><span class="n">top</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span>
</pre></div></div></div><ul>
<li>Make the ball get faster each time it hits the sides
</li></ul>
</div>
<div id="cid36" data-tralics-id="cid36" class="section" data-number="6.4"><h2><a href="5_more_games.html#cid36" class="heading hyperref"><span class="number">6.4 </span>Pong</a></h2>
<p class="noindent">Pong is a classic bat and ball game.</p>
<div class="codelisting" id="code-pong" data-tralics-id="uid87" data-number="6.4"><div class="heading"><span class="number">Program 6.4:</span> <span class="description">Pong</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">ball</span> <span class="o">=</span> <span class="n">Rect</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">bat</span> <span class="o">=</span> <span class="n">Rect</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">480</span><span class="p">),</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">vx</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">vy</span> <span class="o">=</span> <span class="mi">4</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">filled_rect</span><span class="p">(</span><span class="n">ball</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">)</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">filled_rect</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="s2">"white"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">vx</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">vy</span>
    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span> <span class="ow">or</span> <span class="n">ball</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">vx</span>
    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">colliderect</span><span class="p">(</span><span class="n">bat</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ball</span><span class="o">.</span><span class="n">top</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span>
    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span><span class="p">:</span>
        <span class="nb">exit</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="n">keyboard</span><span class="o">.</span><span class="n">right</span><span class="p">):</span>
        <span class="n">bat</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">keyboard</span><span class="o">.</span><span class="n">left</span><span class="p">):</span>
        <span class="n">bat</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mi">2</span>
</pre></div></div></div><ul>
<li>Make the ball more quickly.<span class="intersentencespace"></span>
</li>
<li>Add another bat at the top of the screen for player 2.<span class="intersentencespace"></span>
</li>
<li>Add bricks (Rects) that disappear when the ball hits them.<span class="intersentencespace"></span>
</li></ul>
</div>
<div id="cid37" data-tralics-id="cid37" class="section" data-number="6.5"><h2><a href="5_more_games.html#cid37" class="heading hyperref"><span class="number">6.5 </span>Timer</a></h2>
<p class="noindent">Pygame can tell us how much time has passed since the last frame
in a parameter to our update function.<span class="intersentencespace"></span> We use this to keep a timer.</p>
<div class="codelisting" id="code-timer" data-tralics-id="uid91" data-number="6.5"><div class="heading"><span class="number">Program 6.5:</span> <span class="description">Timer</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="n">timer</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">timer</span>
    <span class="n">timer</span> <span class="o">+=</span> <span class="n">dt</span>


<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">f</span><span class="s2">"Time passed: {timer}"</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">timer</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">textbox</span><span class="p">(</span><span class="s2">"Time's up!"</span><span class="p">,</span> <span class="n">Rect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
</pre></div></div></div><ul>
<li>Make the timer count down, not up.<span class="intersentencespace"></span>
</li>
<li>Add a timer to one of your other games.<span class="intersentencespace"></span>
</li>
<li>Add a timer to <a href="5_more_games.html#code-arrays" class="hyperref">Program <span class="ref">4.5</span></a> that deletes one of the aliens when the timer runs out, then starts the timer again.<span class="intersentencespace"></span>
</li></ul>
</div>
<div id="cid38" data-tralics-id="cid38" class="section" data-number="6.6"><h2><a href="5_more_games.html#cid38" class="heading hyperref"><span class="number">6.6 </span>Another timer</a></h2>
<p class="noindent">Pygame has its own clock which we can use by asking it to <em>call back</em> one of our
functions at a certain time, or regularly over and over at an interval.</p>
<div class="codelisting" id="code-timer2" data-tralics-id="uid95" data-number="6.6"><div class="heading"><span class="number">Program 6.6:</span> <span class="description">Timer with callback functions</span>


</div>

<div class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">aliens</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">add_alien</span><span class="p">():</span>
    <span class="n">aliens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">Actor</span><span class="p">(</span><span class="s2">"alien"</span><span class="p">,</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)))</span>
    <span class="p">)</span>

<span class="c1"># call add_alien once, 0.5 seconds from now</span>
<span class="n">clock</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">add_alien</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># call add_alien over and over again, ever 2 seconds</span>
<span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">add_alien</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">():</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">alien</span> <span class="ow">in</span> <span class="n">aliens</span><span class="p">:</span>
        <span class="n">alien</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div></div></div><ul>
<li>Make the aliens appear much faster
</li>
<li>Use <code>len(aliens)</code> to print how many aliens there are
</li>
<li>When there are too many aliens, stop adding them using this code:
<div class="code"><div class="highlight"><pre><span></span>    <span class="n">clock</span><span class="o">.</span><span class="n">unschedule</span><span class="p">(</span><span class="n">add_alien</span><span class="p">)</span>
</pre></div></div>
</li></ul>
</div>
    </div>
  </body>
</html>
